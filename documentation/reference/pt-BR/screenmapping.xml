<?xml version='1.0' encoding="iso-8859-1"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" []>
<chapter id="behave-screenmapping">
	<title>Criação de Scripts</title>

	<para>
		Esta seção apresenta um roteiro para criação de scripts visuais.
	</para>
	<section>
		<title>Capturando os objetos da tela a serem utilizados</title>
		<para>
			O primeiro passo na criação de um script no Demoiselle-Behave e a escolha dos objetos visuais que
			serão utilizados.
			Os objetos poderão ser identificados de diversas formas como Id,XPath ou CSS. Estas diferentes formas de encontrar
			um objeto na tela são denominadas localizadores. 
			Neste tutorial serão utilizadas algumas ferramentas de apoio para escolha dos objetos. De forma exemplificativa
			o tutorial apresentará um exemplo onde o usuário irá buscar uma informação na página do SERPRO(www.serpro.gov.br).
			

		</para>
		<para>
			<mediaobject>
				<imageobject role="fo">
					<imagedata fileref="images/localizadores.png" align="center"
						format="PNG" />
				</imageobject>
				<imageobject role="html">
					<imagedata fileref="images/localizadores.png" align="center"
						format="PNG" />
				</imageobject>
				<caption>
					<para>Localizadores.
					</para>
				</caption>
			</mediaobject>
		</para>
		<para>
			O próximo passo é utilizar uma ferramenta de apoio para escolher os objetos. O XPath Checker e o FirePath são  ferramentas que permitem 
			obter o Xpath de objetos na tela (https://addons.mozilla.org/pt-br/firefox/addon/xpath-checker/)(https://addons.mozilla.org/en-US/firefox/addon/firepath/).
		</para>
		<para>
			<mediaobject>
				<imageobject role="fo">
					<imagedata fileref="images/xpathchecker.png" align="center"
						format="PNG" scalefit="1" width="75%" />
				</imageobject>
				<imageobject role="html">
					<imagedata fileref="images/xpathchecker.png" align="center"
						format="PNG" scalefit="1" width="75%" />
				</imageobject>
				<caption>
					<para>Ferramenta XPather
					</para>
				</caption>
			</mediaobject>
		</para>
				<para>
			<mediaobject>
				<imageobject role="fo">
					<imagedata fileref="images/firepath.png" align="center"
						format="PNG" scalefit="1" width="75%" />
				</imageobject>
				<imageobject role="html">
					<imagedata fileref="images/firepath.png" align="center"
						format="PNG" scalefit="1" width="75%" />
				</imageobject>
				<caption>
					<para>Ferramenta XPather
					</para>
				</caption>
			</mediaobject>
		</para>
		
		<para>
			Após instalação das ferramentas de apoio devem ser escolhido os objetos que devem interagir com a tela. De forma a exemplificar
			o processo será realizada uma pesquisa na página do SERPRO (www.serpro.gov.br). Sera selecionado o campo de busca e o botão de pesquisa.
			Utilizando o firepath é identificado o id do campo de pesquisa.			
		</para>
		<para>
			<mediaobject>
				<imageobject role="fo">
					<imagedata fileref="images/paginaserproreduzida.png" align="center"
						format="PNG" scalefit="1" width="75%" />
				</imageobject>
				<imageobject role="html">
					<imagedata fileref="images/paginaserproreduzida.png" align="center"
						format="PNG" scalefit="1" width="75%" />
				</imageobject>
				<caption>
					<para>Utilizando firepath para descobrir xpath de objeto
					</para>
				</caption>
			</mediaobject>
		</para>
		<para>
		Uma vez utilizado o firepath descobre-se que o xpath do campo de busca possui o valor <emphasis>.//*[@id='searchGadget']</emphasis> e o xpath
		do botão de busca possui o valor <emphasis>.//*[@id='livesearch0']/div/input[1]</emphasis>.
		</para>
	</section>
	<section>
		<title>Criação do Projeto</title>
		<para>
			O primeiro passo na criação de um projeto Demoisele-Behave é
			criar um projeto Maven com o arquetipo adequado ao projeto de testes.
			Neste tutorial será utilizado o arquetipo jbehave-selenium-archetype.
			O primeiro passo é escolher a opção File>New>Other>Maven>Maven
			Project.

		</para>
		<para>
			<mediaobject>
				<imageobject role="fo">
					<imagedata fileref="images/criandoprojeto1.png" align="center"
						format="PNG" scalefit="1" width="75%" />
				</imageobject>
				<imageobject role="html">
					<imagedata fileref="images/criandoprojeto1.png" align="center"
						format="PNG" />
				</imageobject>
				<caption>
					<para>Escolhendo Maven Project.
					</para>
				</caption>
			</mediaobject>
		</para>
		<para>
			Escolher o catalogo Demoisele-Behave e escolher o arquetipo do
			selenium.
		</para>
		<para>
			<mediaobject>
				<imageobject role="fo">
					<imagedata fileref="images/arquetipo.png" align="center"
						format="PNG" scalefit="1" width="75%" />
				</imageobject>
				<imageobject role="html">
					<imagedata fileref="images/arquetipo.png" align="center"
						format="PNG" />
				</imageobject>
				<caption>
					<para>Escolhendo o arquétipo jbehave-selenium-archetype.
					</para>
				</caption>
			</mediaobject>
		</para>
		<para>
			Preencher o Group Id e Artifact Id e finalizar a criação do
			projeto.
		</para>
		<para>
			<mediaobject>
				<imageobject role="fo">
					<imagedata fileref="images/criandoprojeto3.png" align="center"
						format="PNG" scalefit="1" width="75%" />
				</imageobject>
				<imageobject role="html">
					<imagedata fileref="images/criandoprojeto3.png" align="center"
						format="PNG" />
				</imageobject>
				<caption>
					<para>Escolhendo o arquétipo jbehave-selenium-archetype.
					</para>
				</caption>
			</mediaobject>
		</para>
	</section>
	<section>
		<title>Estrutura de diretórios</title>
		<para>
			O projeto criado a partir do arquétipo possui os diretórios
			src/test/java e src/test/resources. No diretório src/test/resource
			estarão contidas as histórias de usuários. No diretório src/test/java
			estarão contidos os Steps do demoiselle bem como os objetos
			responsáveis pela indentificação das telas envolvidas nos testes e
			seus objetos.
		</para>
		<para>
			<mediaobject>
				<imageobject role="fo">
					<imagedata fileref="images/diretorioprojeto1.png" align="center"
						format="PNG" scalefit="1" width="75%" />
				</imageobject>
				<imageobject role="html">
					<imagedata fileref="images/diretorioprojeto1.png" align="center"
						format="PNG" />
				</imageobject>
				<caption>
					<para>Estrutura de pastas do projeto criado a partir do arquétipo.
					</para>
				</caption>
			</mediaobject>
		</para>
	</section>
	<section>
		<title>Executando Teste</title>
		<para>
			A classe AppTest é responsável pela configuração da pasta onde
			estão
			localizadas as histórias de usuários bem como os passos (Steps)
			a
			serem adicionados
			no projeto.
		</para>

		<para>
			<mediaobject>
				<imageobject role="fo">
					<imagedata fileref="images/classeapptest.png" align="center"
						format="PNG" scalefit="1" width="75%" />
				</imageobject>
				<imageobject role="html">
					<imagedata fileref="images/classeapptest.png" align="center"
						format="PNG" />
				</imageobject>
				<caption>
					<para>Classe AppTest.
					</para>
				</caption>
			</mediaobject>
		</para>
		<para>
			O projeto criado ja possui um exemplo que realiza uma consulta
			no
			Google. Para executar o teste
			basta clicar com o botão direito na
			classe AppTeste e escolher Run
			as>JUnit Test.
		</para>
		<para>
			<mediaobject>
				<imageobject role="fo">
					<imagedata fileref="images/executandoteste.png" align="center"
						format="PNG" scalefit="1" width="75%" />
				</imageobject>
				<imageobject role="html">
					<imagedata fileref="images/executandoteste.png" align="center"
						format="PNG" />
				</imageobject>
				<caption>
					<para>Classe AppTest
					</para>
				</caption>
			</mediaobject>
		</para>
		<para>
			O framework inicia o Driver e abre o navegador.
		</para>
		<para>
			<mediaobject>
				<imageobject role="fo">
					<imagedata fileref="images/console1.png" align="center"
						format="PNG" scalefit="1" width="75%" />
				</imageobject>
				<imageobject role="html">
					<imagedata fileref="images/console1.png" align="center"
						format="PNG" />
				</imageobject>
				<caption>
					<para>Classe AppTest
					</para>
				</caption>
			</mediaobject>
		</para>
		<para>
			Abaixo segue uma das histórias executadas pelo framework:
			<programlisting>
		
				Funcionalidade: Pesquisa Simples

				Como um: visitante
				Eu quero: fazer uma busca simples
				De modo que: me mostre os resultados

				Cenário: Utilização da funcionalidade de pesquisa

				Acesso ao Google
				Quando informo "Framework Demoiselle" no campo "Campo de Busca"
				Então será exibido "frameworkdemoiselle.gov.br"
		</programlisting>
		</para>
		<para>
			O framework associa o campo
			<emphasis>"Campo Busca"</emphasis>
			com o elemento searchField da classe MyPage criada
			de forma a
			mapear os objetos da tela com o Id procurado. O Elemento
			locatorType
			informa o tipo de
			reconhecimento de objetos será utilizado
			no
			framework. No exemplo, será localizado o elemento cujo Id
			possui o
			valor "gbqfq".

		</para>
		<programlisting>
		
@ScreenMap(name = "Tela de Busca", location = "http://www.google.com.br")
public class MyPage {

	@ElementMap(name = "Campo de Busca", locatorType = ElementLocatorType.Id, locator = "gbqfq")
	private TextField searchField;

	@ElementMap(name = "Estou com sorte", locatorType = ElementLocatorType.Id, locator = "gbqfbb")
	private Button buttonLuckSearch;

}

		
		</programlisting>
	</section>

</chapter>
